(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{296:function(s,n,t){s.exports=t.p+"assets/img/16b4bca62550d704.0de0cf2f.png"},297:function(s,n,t){s.exports=t.p+"assets/img/16b4bca62635dad1.c3789bfe.png"},298:function(s,n,t){s.exports=t.p+"assets/img/16b4bca62c7a5a90.f7ae007c.png"},299:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6270f8281.637be668.png"},300:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6671d77c0.88378f32.png"},301:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6775ea901.1cfb781a.png"},302:function(s,n,t){s.exports=t.p+"assets/img/16b4bca66df8a1b9.d28a93f8.png"},303:function(s,n,t){s.exports=t.p+"assets/img/16b4bca66e2afe7f.07a4e264.png"},304:function(s,n,t){s.exports=t.p+"assets/img/16b4bca67cc7c63c.fdae2d8e.png"},305:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6bd11f4b5.e64889f2.png"},306:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6bd2a8d3b.213379b3.png"},307:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6bd6b2d68.d96d3012.png"},308:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6bda06c02.39ede39a.png"},309:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6bdbecd2e.a77a3a71.png"},310:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6c136140e.ebd6643a.png"},311:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6f46ca696.4c9c59e1.png"},312:function(s,n,t){s.exports=t.p+"assets/img/16b4bca6fa2fed4f.dff2b6a0.png"},884:function(s,n,t){"use strict";t.r(n);var a=t(28),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[s._v("#")]),s._v(" 一、背景")]),s._v(" "),a("p",[s._v("最近收到阿里云短信，提示个站 "),a("a",{attrs:{href:"https://www.exception.site",target:"_blank",rel:"noopener noreferrer"}},[s._v("www.exception.site"),a("OutboundLink")],1),s._v(" 的云盾 SSL 证书(Https 证书)即将到期，需要赶快续费，不然无法继续使用 Https 协议来访问网站！")]),s._v(" "),a("p",[s._v("这个 SSL 证书当时用的是阿里云免费型的，有效期为 1 年，到期后, 如果想继续使用这个证书，就得续费，而且费用还不低！")]),s._v(" "),a("p",[s._v("其实，要想继续使用 Https 协议，我们可以在阿里云上再次申请一张 SSL 证书就可以了，时间一年，嗨呀，又能免费用一年。")]),s._v(" "),a("p",[s._v("本文主要介绍如何在 Ngnix 上配置 SSL 证书，从而让我们的网站能够使用 Https 来访问，另外再附带说一下如何配置反向代理。")]),s._v(" "),a("h2",{attrs:{id:"二、docker-快速安装-搭建-ngnix-环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、docker-快速安装-搭建-ngnix-环境"}},[s._v("#")]),s._v(" 二、Docker 快速安装&搭建 Ngnix 环境")]),s._v(" "),a("p",[s._v("小哈的个站 Ngnix 搭建在容器当中，也就顺便说一下如何通过 Docker 快速安装&搭建 Ngnix 环境。")]),s._v(" "),a("h3",{attrs:{id:"_2-1-下载-nginx-镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-下载-nginx-镜像"}},[s._v("#")]),s._v(" 2.1 下载 Nginx 镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker pull nginx:alpine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("blockquote",[a("p",[s._v("PS：我这里用的是 alipne 轻量级的镜像.")])]),s._v(" "),a("p",[s._v("下载完成后，通过 "),a("code",[s._v("docker images")]),s._v(" 命令检查一下镜像是否下载成功：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(296),alt:"检查ngnix镜像是否下载成功"}})]),s._v(" "),a("h3",{attrs:{id:"_2-2-先以简单的方式运行镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-先以简单的方式运行镜像"}},[s._v("#")]),s._v(" 2.2 先以简单的方式运行镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -d -p 80:80 --name nginx nginx:alpine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("-p 80:80")]),s._v(": 将容器的 80 端口映射到宿主机的 80 端口上；")]),s._v(" "),a("li",[a("code",[s._v("-d")]),s._v(": 以后台方式运行镜像；")]),s._v(" "),a("li",[a("code",[s._v("--name")]),s._v(": 指定容器的名称为 nginx;")])]),s._v(" "),a("p",[s._v("命令执行完成后，通过 "),a("code",[s._v("docker ps")]),s._v("命令确认一下容器是否启动成功。确认成功后，再访问一下 "),a("code",[s._v("80")]),s._v(" 端口，看看 nginx 服务是否启动成功：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(297),alt:"nginx访问成功"}})]),s._v(" "),a("h3",{attrs:{id:"_2-3-复制相关配置文件至宿主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-复制相关配置文件至宿主机"}},[s._v("#")]),s._v(" 2.3 复制相关配置文件至宿主机")]),s._v(" "),a("p",[s._v("复制运行中 nginx 相关配置文件到宿主机的指定路径下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制名称为 nginx 容器中 /etc/nginx/nginx.conf 文件夹到宿主机的 /docker/nginx 路径下")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" nginx:/etc/nginx/nginx.conf /docker/nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制名称为 nginx 容器中 /etc/nginx/conf.d 文件到宿主机的 /docker/nginx 路径下")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" nginx:/etc/nginx/conf.d /docker/nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("复制完成后，查看指定路径的配置文件，如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(298),alt:"img"}})]),s._v(" "),a("h2",{attrs:{id:"三、配置-ssl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、配置-ssl"}},[s._v("#")]),s._v(" 三、配置 SSL")]),s._v(" "),a("h3",{attrs:{id:"_3-1-免费获取-ssl-证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-免费获取-ssl-证书"}},[s._v("#")]),s._v(" 3.1 免费获取 SSL 证书")]),s._v(" "),a("p",[s._v("访问链接 "),a("a",{attrs:{href:"https://common-buy.aliyun.com/?spm=5176.2020520163.cas.3.4bf91BFD1BFDcm&commodityCode=cas#/buy",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://common-buy.aliyun.com/?spm=5176.2020520163.cas.3.4bf91BFD1BFDcm&commodityCode=cas#/buy"),a("OutboundLink")],1),s._v("：")]),s._v(" "),a("blockquote",[a("p",[s._v("PS: 注意，未注册阿里云账号的童鞋，需要先注册一个账号哟~")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(299),alt:"img"}})]),s._v(" "),a("p",[s._v("选择"),a("strong",[s._v("免费 DV SSL 证书")]),s._v(" -> "),a("strong",[s._v("立即购买")]),s._v("，完成后，进入阿里云后台查看：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(300),alt:"img"}})]),s._v(" "),a("p",[s._v("这里需要申请签发，填写相关信息后，等待签发通过即可。")]),s._v(" "),a("p",[a("img",{attrs:{src:t(301),alt:"img"}})]),s._v(" "),a("p",[s._v("签发通过后，我们下载证书：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(302),alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:t(303),alt:"img"}})]),s._v(" "),a("p",[s._v("这里我选择的是 Ngnix, 当然了，你也可以选择 Tomcat、Apache、IIS 等。")]),s._v(" "),a("h3",{attrs:{id:"_3-2-解压上传到服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-解压上传到服务器"}},[s._v("#")]),s._v(" 3.2 解压上传到服务器")]),s._v(" "),a("p",[s._v("下载下来后，解压，我们可以看到包含两个文件：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(304),alt:"img"}})]),s._v(" "),a("p",[s._v("接下来，我们先在容器的挂载目录下创建 "),a("code",[s._v("cert")]),s._v(" 证书目录：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(305),alt:"img"}})]),s._v(" "),a("p",[s._v("将解压后的两个文件上传至该目录中。")]),s._v(" "),a("p",[a("img",{attrs:{src:t(306),alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"_3-3-配置-ngnix-ssl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-配置-ngnix-ssl"}},[s._v("#")]),s._v(" 3.3 配置 Ngnix SSL")]),s._v(" "),a("p",[s._v("这里需要说一下，运行在 docker 容器中的 nginx 版本，信息如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(307),alt:"img"}})]),s._v(" "),a("p",[s._v("因为我的 nginx 相对版本较高，可能和大家的配置文件目录有些不同，但整体的没啥大的问题，该怎么配置，还是怎么配置：")]),s._v(" "),a("p",[s._v("首先创建 "),a("code",[s._v("ssl.conf")]),s._v(" 配置文件，专门用来配置 "),a("code",[s._v("ssl")]),s._v(" 相关参数：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(308),alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(" ssl http"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(";\n    server_name  exception.site www.exception.site;\n\n    client_max_body_size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("M;\n    #charset koi"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("-r;\n    #access_log  /var/log/nginx/host.access.log  main;\n\n    ssl on;\n    root html;\n    index index.html index.htm;\n    ssl_certificate /etc/nginx/cert/"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2256161")]),s._v("_www.exception.site.pem;\n    ssl_certificate_key  /etc/nginx/cert/"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2256161")]),s._v("_www.exception.site.key;\n    ssl_session_timeout "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("m;\n    ssl_ciphers ECDHE-RSA-AES"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("-GCM-SHA"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("ECDHE"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("ECDH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("AES"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("HIGH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("!NULL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("!aNULL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("!MD"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("!ADH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("!RC"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(";\n    ssl_protocols TLSv"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" TLSv"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(" TLSv"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(";\n    ssl_prefer_server_ciphers on;\n\n   location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_pass http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//172.17.0.1:8090;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    #error_page  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v("              /"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404.")]),s._v("html;\n\n    # redirect server error pages to the static page /"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("x.html\n    #\n    error_page   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("x.html;\n    location = /"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root   /usr/share/nginx/html;\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("根据阿里云的文档说明加上 "),a("code",[s._v("ssl")]),s._v(" 相关参数，如 ssl 证书的两个文件目录，另外同时监听 "),a("code",[s._v("443")]),s._v(" 端口。")]),s._v(" "),a("p",[s._v("再贴下 "),a("code",[s._v("defaut.conf")]),s._v(" 配置文件内容：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(309),alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(";\n    server_name  exception.site www.exception.site;\n    return "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("301")]),s._v(" https"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//$host$request_uri;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("可以看到，主要对 "),a("code",[s._v("http 80")]),s._v(" 端口主要做了一下 "),a("code",[s._v("301")]),s._v(" 重定向，也就是说，如果前端使用的 "),a("code",[s._v("http")]),s._v(" 访问，这里会重定向到 "),a("code",[s._v("https 协议")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"四、配置反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、配置反向代理"}},[s._v("#")]),s._v(" 四、配置反向代理")]),s._v(" "),a("p",[s._v("再来说说如何配置反向代理，先通过命令 "),a("code",[s._v("ifconfig")]),s._v(" 命令获取 "),a("code",[s._v("docker0")]),s._v("网卡的 ip 地址：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(310),alt:"img"}})]),s._v(" "),a("blockquote",[a("p",[s._v("PS: 因为我需要反向代理的服务部署在本机的 Docker 容器中，所以用的这个 IP，如果你用的外网其他地址，可自行修改。")])]),s._v(" "),a("p",[s._v("由于上面我们已经新建了一个 "),a("code",[s._v("ssl.conf")]),s._v(" 配置文件，这里就直接将反向代理的配置写在里面：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("proxy_set_header Host $host;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_pass http://172.17.0.1:8090;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:t(311),alt:"img"}})]),s._v(" "),a("p",[s._v("通过配置，我们反向代理到了 "),a("code",[s._v("8090")]),s._v(" 端口的 Spring Boot 服务。")]),s._v(" "),a("h2",{attrs:{id:"五、重启-nginx-容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、重启-nginx-容器"}},[s._v("#")]),s._v(" 五、重启 Nginx 容器")]),s._v(" "),a("p",[s._v("先删除之前启动的 nginx 容器：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("成功后，回到配置文件的主目录，执行：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker run -d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" \n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(":443 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" \n--name nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /docker/nginx/conf.d:/etc/nginx/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /docker/nginx/logs:/var/log/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /docker/nginx/cert:/etc/nginx/cert "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nnginx:alpine \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-p 80:80 -p 443:443")]),s._v("：将容器的 80、443 端口映射到主机的 80、443 端口；")]),s._v(" "),a("li",[a("code",[s._v("-v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf")]),s._v("：将容器中的 /etc/nginx/nginx.conf 文件挂载到宿主机中的 /docker/nginx/nginx.conf 文件；")]),s._v(" "),a("li",[a("code",[s._v("-v /docker/nginx/conf.d:/etc/nginx/conf.d")]),s._v("：将容器中 /etc/nginx/conf.d 目录挂载到宿主机中的 conf.d 目录下；")]),s._v(" "),a("li",[a("code",[s._v("-v /docker/nginx/logs:/var/log/nginx")]),s._v("：将容器中的 /var/log/nginx 目录挂载到宿主机中的 /docker/nginx/logs 目录下, 用以查看 Nginx 日志；")]),s._v(" "),a("li",[a("code",[s._v("-v /docker/nginx/cert:/etc/nginx/cert")]),s._v(": 将容器中的 /etc/nginx/cert 证书目录挂载到宿主机中的 /docker/nginx/cert 证书目录下；")])]),s._v(" "),a("blockquote",[a("p",[s._v("注意：因为我使用的阿里云服务器，同时还需要将 443 端口加入到安全组中，才能保证外界的正常访问 https 端口")])]),s._v(" "),a("p",[s._v("运行命令成功后，通过 https 协议来访问我们的网站域名 "),a("a",{attrs:{href:"https:///www.exception.site",target:"_blank",rel:"noopener noreferrer"}},[s._v("www.exception.site"),a("OutboundLink")],1),s._v("，看看是否能够正常访问，并且方向代理到 8090 端口的 Spring Boot 服务上：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(312),alt:"img"}})]),s._v(" "),a("p",[s._v("OK! 大工告成。")]),s._v(" "),a("h2",{attrs:{id:"六-、最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六-、最后"}},[s._v("#")]),s._v(" 六 、最后")]),s._v(" "),a("p",[s._v("本文中，我们学习了如何通过 Docker 快速搭建 Nginx 环境，并对其配置 SSL 证书和反向代理，让网站能够以 Https 协议来访问。希望童鞋们看完本文能够有所收获~")])])}),[],!1,null,null,null);n.default=e.exports}}]);