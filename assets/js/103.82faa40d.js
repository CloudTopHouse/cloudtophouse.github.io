(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{1231:function(v,_,e){"use strict";e.r(_);var t=e(42),a=Object(t.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"_02-论「版本号」的正确使用方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_02-论「版本号」的正确使用方式"}},[v._v("#")]),v._v(" 02-论「版本号」的正确使用方式")]),v._v(" "),t("p",[v._v("[TOC]")]),v._v(" "),t("p",[t("img",{attrs:{src:e(862),alt:""}})]),v._v(" "),t("p",[v._v("版本号，说白了就是我们为项目的每个不同版本起的标识号，其被广泛运用于开发的各种场景：NPM（Node Package Manager） 的版本定义、对 NPM 包的特定版本的依赖指定、Git 的 daily 版本号分支等等。面对如此多的场景，版本号的命名却存在很大问题。例如：")]),v._v(" "),t("ul",[t("li",[v._v("开始写一个新项目 / 模块时，不管三七二十一，都从"),t("code",[v._v("0.0.1")]),v._v("起版本，直到项目不再维护时，版本还停留在"),t("code",[v._v("0.0.48")]),v._v("，前两位永远都是"),t("code",[v._v("0")]),v._v("。")]),v._v(" "),t("li",[v._v("API 变化巨大，而版本号雷打不动一步一个脚印。一个二方包从"),t("code",[v._v("0.0.8")]),v._v("升级到"),t("code",[v._v("0.0.9")]),v._v("就引起了整个项目的崩溃。")]),v._v(" "),t("li",[v._v("依赖二方 / 三方包时，不知道该依赖哪个版本，有时随便指定了一个，有时则直接依赖了。")])]),v._v(" "),t("h2",{attrs:{id:"版本号的命名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#版本号的命名"}},[v._v("#")]),v._v(" 版本号的命名")]),v._v(" "),t("p",[v._v("根据国际主流的惯例，我们使用「语义化版本（Semantic Versioning）」的命名方式，有时简称 SemVer。语义化版本号（以下简称「版本号」）的格式是："),t("code",[v._v("<major>.<minor>.<patch>")]),v._v("。即使用三位非负整数，以点号"),t("code",[v._v(".")]),v._v("连接。")]),v._v(" "),t("ul",[t("li",[v._v("如："),t("code",[v._v("1.4.15")]),v._v("、"),t("code",[v._v("6.2.0")]),v._v("。")])]),v._v(" "),t("h3",{attrs:{id:"每一位版本号的含义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#每一位版本号的含义"}},[v._v("#")]),v._v(" 每一位版本号的含义")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("<major>")]),v._v("即主版本号，俗称大版本升级。改动到主版本号时，标志着 API 发生了巨大变化，包括但不限于新增特性、修改机制、删除功能， 一般不兼容上一个主版本号。")]),v._v(" "),t("li",[t("code",[v._v("<minor>")]),v._v("即次版本号，俗称小版本升级。当我们进行常规的新增或修改功能时，改动次版本号，但是必须是向前兼容的。这也意味着我们不能直接删除某个功能。如若必要，我们可以在修改日志中标记某项功能为「即将删除（Deprecated）」，然后在下一个大版本中将其彻底删除。")]),v._v(" "),t("li",[t("code",[v._v("<patch>")]),v._v("即修订号，俗称 bug 修复。顾名思义，如果仅仅为了修复或调整一些小问题，我们就只改动修订号。")])]),v._v(" "),t("p",[v._v("所以，当我们明确了每一位的含义和作用后，就不会陷入「每次只改最末位」的尴尬中了。那如何判断一个修改应该是改动修订号还是次版本号呢？视情况而定。比如对于「修改了 app 图标」这件事来说，如果只是调整了图标的间距位置，那么可以认作问题修复；如果把整个图标换了，配上了不同的标语，那么这应该是一次功能改动。")]),v._v(" "),t("h3",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[v._v("#")]),v._v(" 注意事项")]),v._v(" "),t("ul",[t("li",[v._v("版本号前不要加"),t("code",[v._v("v")]),v._v("。")]),v._v(" "),t("li",[v._v("不要在数字前补"),t("code",[v._v("0")]),v._v("。错误示例："),t("code",[v._v("01.12.03")]),v._v("。")]),v._v(" "),t("li",[v._v("每一位版本号按照"),t("code",[v._v("+1")]),v._v("的速度递增，不要在版本号之间跳跃。")]),v._v(" "),t("li",[v._v("主版本号停留在"),t("code",[v._v("0")]),v._v("的版本号，即"),t("code",[v._v("0.x.x")]),v._v("应当视作还在内部开发阶段的代码。如果代码有公共 API，此时不宜对外公开。")]),v._v(" "),t("li",[t("code",[v._v("1.0.0")]),v._v("的版本号用于界定公共 API 的形成。")]),v._v(" "),t("li",[v._v("当次版本号递增时，修订号归零；当主版本号递增时，次版本号、修订号归零。")]),v._v(" "),t("li",[v._v("进行新的开发时，版本号从"),t("code",[v._v("0.1.0")]),v._v("开始。")]),v._v(" "),t("li",[v._v("如果不小心把一个不兼容的改版当成了次版本号发行，应当发行一个新的次版本号来更正这个问题并且恢复向下兼容。注意"),t("strong",[v._v("不能去修改已发行的版本")]),v._v("。")])]),v._v(" "),t("h3",{attrs:{id:"一个典型的版本号发展示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一个典型的版本号发展示例"}},[v._v("#")]),v._v(" 一个典型的版本号发展示例")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("0.1.0")])]),v._v(" "),t("li",[t("code",[v._v("0.1.1")])]),v._v(" "),t("li",[t("code",[v._v("0.1.2")])]),v._v(" "),t("li",[t("code",[v._v("0.2.0")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0")])]),v._v(" "),t("li",[t("code",[v._v("1.1.0")])]),v._v(" "),t("li",[t("code",[v._v("1.1.1")])]),v._v(" "),t("li",[t("code",[v._v("……")])])]),v._v(" "),t("h3",{attrs:{id:"快速修改版本号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速修改版本号"}},[v._v("#")]),v._v(" 快速修改版本号")]),v._v(" "),t("p",[v._v("如果一个包发布在 NPM / TNPM 中，可以快速修改其版本号。会自动触发一个 Git 提交。")]),v._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[v._v("# 递增一个修订号")]),v._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[v._v("npm")]),v._v(" version patch\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[v._v("# 递增一个次版本号")]),v._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[v._v("npm")]),v._v(" version minor\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[v._v("# 递增一个主版本号")]),v._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[v._v("npm")]),v._v(" version major12345678\n")])]),v._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[v._v("1")]),t("br"),t("span",{staticClass:"line-number"},[v._v("2")]),t("br"),t("span",{staticClass:"line-number"},[v._v("3")]),t("br"),t("span",{staticClass:"line-number"},[v._v("4")]),t("br"),t("span",{staticClass:"line-number"},[v._v("5")]),t("br"),t("span",{staticClass:"line-number"},[v._v("6")]),t("br"),t("span",{staticClass:"line-number"},[v._v("7")]),t("br"),t("span",{staticClass:"line-number"},[v._v("8")]),t("br")])]),t("hr"),v._v(" "),t("h2",{attrs:{id:"预发版本号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#预发版本号"}},[v._v("#")]),v._v(" 预发版本号")]),v._v(" "),t("p",[v._v("在常规的版本号命名之上还有一个特殊类别，叫做预发版本号（Prerelease Version）。它表示当前版本是一个不稳定的版本，使用它时需要注意风险。")]),v._v(" "),t("p",[v._v("预发版本号的格式是"),t("code",[v._v("<major>.<minor>.<patch>-<tag>")]),v._v("，即前半部分和常规版本号相同，然后跟上连接符"),t("code",[v._v("-")]),v._v("，后面再跟上字母数字点号连接符（"),t("code",[v._v("[0-9A-Za-z-.]")]),v._v("）。")]),v._v(" "),t("p",[v._v("一个典型的预发版本号形如"),t("code",[v._v("1.0.0-beta.1")]),v._v("。建议使用这种"),t("code",[v._v("<major>.<minor>.<patch>-<stage>.<num>")]),v._v("的形式。其中"),t("code",[v._v("<stage>")]),v._v("一般选用："),t("code",[v._v("alpha")]),v._v("、"),t("code",[v._v("beta")]),v._v("、"),t("code",[v._v("rc")]),v._v("。")]),v._v(" "),t("p",[v._v("预发版本号是常规版本号的附属，因此在版本的大小比较上，仍然先比较常规版本号部分；对于预发标记部分的比较，则是根据 ASCII 字母表中的顺序来进行。")]),v._v(" "),t("h3",{attrs:{id:"一个典型的预发版本号发展示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一个典型的预发版本号发展示例"}},[v._v("#")]),v._v(" 一个典型的预发版本号发展示例")]),v._v(" "),t("ul",[t("li",[t("code",[v._v("0.9.0")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0-alpha.1")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0-alpha.2")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0-beta.1")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0-rc.1")])]),v._v(" "),t("li",[t("code",[v._v("1.0.0")])]),v._v(" "),t("li",[t("code",[v._v("1.0.1")])]),v._v(" "),t("li",[t("code",[v._v("……")])])]),v._v(" "),t("h3",{attrs:{id:"依赖的版本号标记法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖的版本号标记法"}},[v._v("#")]),v._v(" 依赖的版本号标记法")]),v._v(" "),t("p",[v._v("我们广泛使用的 NPM 本身也遵从 SemVer 版本号命名，除了包版本本身的定义之外，最重要的是对三方包依赖的版本号的定义，不当的写法将导致一系列潜在的问题。")]),v._v(" "),t("h3",{attrs:{id:"指定可用的版本号范围"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指定可用的版本号范围"}},[v._v("#")]),v._v(" 指定可用的版本号范围")]),v._v(" "),t("p",[v._v("在 NPM 包的 deps 系列字段中，经常出现形如"),t("code",[v._v("~1.0.4")]),v._v("、"),t("code",[v._v("^2.1.1")]),v._v(" 这样的标记法，这种标记法标记的是「版本号范围（Version Range）」，它表示依赖的三方包其版本号只要落在定义版本号范围内，即算合法。另外，当运行 npm update 时，依赖的包将升级到版本号范围支持的最高版本。")]),v._v(" "),t("p",[v._v("版本号范围的标记符号有很多种，诸如比较符号"),t("code",[v._v(">=")]),v._v("、"),t("code",[v._v("<")]),v._v("等；连接符"),t("code",[v._v("-")]),v._v("；通配符"),t("code",[v._v("x")]),v._v("、"),t("code",[v._v("*")]),v._v("；模糊符"),t("code",[v._v("^")]),v._v("、"),t("code",[v._v("~")]),v._v("。具体的用法可参考「"),t("a",{attrs:{href:"https://docs.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[v._v("NPM 官方文档"),t("OutboundLink")],1),v._v("」，这里仅给出常用的标记方式。")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("含义")]),v._v(" "),t("th",[v._v("最简")]),v._v(" "),t("th",[v._v("通配符")]),v._v(" "),t("th",[v._v("模糊符")]),v._v(" "),t("th",[v._v("版本号范围")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("仅跟进修复版本")]),v._v(" "),t("td",[t("code",[v._v("1.0")])]),v._v(" "),t("td",[t("code",[v._v("1.0.x")])]),v._v(" "),t("td",[t("code",[v._v("~1.0.4")])]),v._v(" "),t("td",[t("code",[v._v(">=1.0.4 <1.1.0")])])]),v._v(" "),t("tr",[t("td",[v._v("跟进每个小版本更新")]),v._v(" "),t("td",[t("code",[v._v("1")])]),v._v(" "),t("td",[t("code",[v._v("1.x")]),v._v("、"),t("code",[v._v("1.x.x")])]),v._v(" "),t("td",[t("code",[v._v("^1.0.4")])]),v._v(" "),t("td",[t("code",[v._v(">=1.0.4 <2.0.0")])])]),v._v(" "),t("tr",[t("td",[v._v("始终升级到最新版")]),v._v(" "),t("td",[t("code",[v._v("*")])]),v._v(" "),t("td",[t("code",[v._v("*")])]),v._v(" "),t("td",[t("code",[v._v("*")])]),v._v(" "),t("td",[t("code",[v._v(">=0.0.0")])])])])]),v._v(" "),t("p",[v._v("我们建议在写法上采用 「"),t("strong",[v._v("使用通配符的写法")]),v._v("」，并且一般情况下 「"),t("strong",[v._v("跟进每个小版本更新")]),v._v("」，但"),t("strong",[v._v("不「始终升级到最新版」")]),v._v("，即书写为"),t("code",[v._v("1.x")]),v._v("。由于"),t("code",[v._v("<major>")]),v._v("位版本是不向下兼容的，所以在大版本的控制上，仍然采用人为干预以保证安全。")]),v._v(" "),t("h3",{attrs:{id:"不同的-deps-字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不同的-deps-字段"}},[v._v("#")]),v._v(" 不同的 deps 字段")]),v._v(" "),t("p",[v._v("NPM 包中的依赖有几种形式的字段：dependencies、devDependencies、peerDependencies。以下简要介绍下各字段的不同含义，以及使用场景。")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("字段")]),v._v(" "),t("th",[v._v("含义")]),v._v(" "),t("th",[v._v("依赖被安装的时机")]),v._v(" "),t("th",[v._v("使用场景")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("dependencies")]),v._v(" "),t("td",[v._v("运行时依赖，包的调用者需要使用到的依赖")]),v._v(" "),t("td",[v._v("执行 npm install 后会把当前包的dependencies 字段中的所有依赖项安装到"),t("code",[v._v("./node_modules")]),v._v("目录。执行 npm install xxx 后会把 xxx 安装到"),t("code",[v._v("./node_modules")]),v._v("下，同时会安装 xxx 的 dependencies 字段依赖项到"),t("code",[v._v("./node_modules/xxx/node_modules")]),v._v("目录。 执行 npm install xxx –save 后会额外把 xxx 作为依赖存到当前包的 dependencies 字段中。")]),v._v(" "),t("td",[v._v("所有程序运行需要用到的依赖代码，如 lodash 等。")])]),v._v(" "),t("tr",[t("td",[v._v("devDependencies")]),v._v(" "),t("td",[v._v("开发时依赖，包的开发维护者需要使用到的依赖")]),v._v(" "),t("td",[v._v("执行 npm install 后也会把当前包的devDependencies 字段中的所有依赖项安装到"),t("code",[v._v("./node_modules")]),v._v("目录。执行 npm install xxx 后会把 xxx 安装到"),t("code",[v._v("./node_modules")]),v._v("下，但不会安装 xxx 的 devDependencies 字段依赖项。执行 npm install xxx –save-dev 后会额外把 xxx 作为开发时依赖存到当前包的 devDependencies 字段中。")]),v._v(" "),t("td",[v._v("一般是一些开发调试的辅助工具，如测试工具 mocha、构建工具 gulp 等。")])]),v._v(" "),t("tr",[t("td",[v._v("peerDependencies")]),v._v(" "),t("td",[v._v("略")]),v._v(" "),t("td",[v._v("略")]),v._v(" "),t("td",[v._v("仅在特定场景下有用，默认不使用此字段。")])])])]),v._v(" "),t("hr"),v._v(" "),t("p",[t("strong",[v._v("转载声明")]),v._v("：本文转自「汇智网」，"),t("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzI3MDAxODk0Ng==&mid=2650015847&idx=1&sn=22cbdc5f33b1b0fa10240fe7bea88bd4&mpshare=1&scene=23&srcid=0725qNBZrEO9h8NP3svRmdGp#rd",target:"_blank",rel:"noopener noreferrer"}},[v._v("论版本号的正确打开方式"),t("OutboundLink")],1),v._v("，略有修改。")]),v._v(" "),t("h1",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[v._v("#")]),v._v(" 参考文章")]),v._v(" "),t("p",[t("a",{attrs:{href:"https://semver.org/lang/zh-CN/",target:"_blank",rel:"noopener noreferrer"}},[v._v("语义化版本 2.0.0"),t("OutboundLink")],1)]),v._v(" "),t("p",[t("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzI3MDAxODk0Ng==&mid=2650015847&idx=1&sn=22cbdc5f33b1b0fa10240fe7bea88bd4&mpshare=1&scene=23&srcid=0725qNBZrEO9h8NP3svRmdGp#rd",target:"_blank",rel:"noopener noreferrer"}},[v._v("论版本号的正确打开方式"),t("OutboundLink")],1)])])}),[],!1,null,null,null);_.default=a.exports},862:function(v,_,e){v.exports=e.p+"assets/img/20171104134749364.f85d9983.jpg"}}]);